# Sablier Deployments

This repository keeps track of Sablier deployment bundles, each of which includes:

1. Contract artifacts and ABIs.
2. The [broadcast](https://book.getfoundry.sh/guides/scripting-with-solidity) directories generated by Foundry upon
   running the deploy scripts.

The deployments are indexed by:

1. Repository ("lockup" or "flow")
2. Version name (e.g. "v1.0.0")
3. Artifacts
4. Broadcasts, which in turn are indexed by chain name.

If you need the deployment addresses, you can find them in the [docs](https://docs.sablier.com).

## Background

Sablier Protocols have been built, tested, formatted, and deployed with the [Foundry](https://getfoundry.sh) smart
contract development toolchain.

To learn more about Foundry, see the [Foundry Book](https://book.getfoundry.sh).

To learn more about Sablier, see the [Sablier Docs](https://docs.sablier.com).

## Addresses

To view the deployment addresses, use the links below.

- [Airdrops deployment addresses](https://docs.sablier.com/guides/airdrops/deployments)
- [Lockup deployment addresses](https://docs.sablier.com/guides/lockup/deployments)
- [Flow deployment addresses](https://docs.sablier.com/guides/flow/deployments)

### Packages

The contract artifacts and the ABIs are published as NPM packages:

- [@sablier/airdrops](https://npmjs.com/package/@sablier/airdrops)
- [@sablier/lockup](https://npmjs.com/package/@sablier/lockup)
- [@sablier/flow](https://npmjs.com/package/@sablier/flow)

Older versions of Lockup (before v2.0.0) and Airdrops (before v1.3.0) have been published through these packages:

- [@sablier/v2-core](https://npmjs.com/package/@sablier/v2-core)
- [@sablier/v2-periphery](https://npmjs.com/package/@sablier/v2-periphery)

## Scripts

The contracts have been deployed using these scripts:

- [airdrops/script](https://github.com/sablier-labs/airdrops/tree/main/script)
- [lockup/script](https://github.com/sablier-labs/lockup/tree/main/script)
- [flow/script](https://github.com/sablier-labs/flow/tree/main/script)

Specifically, with the "DeployDeterministic" scripts, which rely upon this CREATE2 factory:

- https://github.com/Arachnid/deterministic-deployment-proxy

### Differentiation

The rationale for using CREATE2 is not to generate deterministic deployment addresses - quite the opposite. The goal is
to have different addresses on each chain. By using CREATE2, we can systematically differentiate the contract addresses
by passing a salt, whereas if we had used CREATE, the deployer's nonce would have impacted the resulting deployment
address.

## Logging

This project uses Winston for logging. By default, logs are output to the console, but they can also be written to a
file by setting the following environment variables:

- `LOG_FILE_PATH`: Path to the log file (e.g., `./logs/deployments.log`). When set, logs will be written to this file in
  addition to the console.
- `LOG_LEVEL`: Set the logging level (default: `info`). Valid values are: `error`, `warn`, `info`, `verbose`, `debug`,
  and `silly`.

Example usage:

```bash
# Log to both console and file
LOG_FILE_PATH=./logs/deployments.log bun run build

# Set a custom log level
LOG_LEVEL=debug LOG_FILE_PATH=./logs/debug.log bun run test
```

## License

This repo is licensed under GPL 3-0 or later.
